graph TD
    %% --- Componentes ---
    %% Usamos colchetes [ ] para ret√¢ngulos padr√£o
    %% Usamos par√™nteses e colchetes [( )] para representar bancos de dados

    User[üë§ Usu√°rio / Navegador]
    LB[‚öñÔ∏è Load Balancer]
    Gateway[üö™ API Gateway]

    %% Agrupando os servi√ßos de backend para organiza√ß√£o visual
    subgraph Camada de Aplica√ß√£o
        CartService[üõí Servi√ßo de Carrinho API]
        OrderService[üí≤ Servi√ßo de Pedidos/Checkout]
        ProductService[üì¶ Servi√ßo de Cat√°logo]
    end

    %% Os armazenamentos de dados
    RedisCache[(‚ö° Cache de Carrinho\nRedis - Mem√≥ria R√°pida)]
    MainDB[(üóÑÔ∏è Banco de Dados Principal\nMySQL/Postgres - Persistente)]


    %% --- Fluxos ---

    %% 1. Entrada
    User -->|Requisi√ß√£o HTTP| LB
    LB --> Gateway

    %% 2. Navega√ß√£o Normal (Cat√°logo)
    Gateway -->|Busca Produtos| ProductService
    ProductService -->|L√™ Cat√°logo| MainDB

    %% 3. Fluxo do Carrinho (O "Web Cache")
    %% Linha grossa para enfatizar o caminho de alta performance
    Gateway ==>|Adicionar/Ver Itens| CartService
    CartService <==>|‚ö° Leitura/Escrita instant√¢nea do estado| RedisCache

    %% 4. Fluxo de Checkout (A transi√ß√£o)
    Gateway -->|Finalizar Compra POST| OrderService
    OrderService -->|1. Obt√©m dados finais do carrinho| CartService
    OrderService -->|2. Grava pedido permanente| MainDB
    %% Linha pontilhada para indicar uma a√ß√£o secund√°ria (limpeza)
    OrderService -.->|3. Deleta carrinho ap√≥s sucesso| RedisCache